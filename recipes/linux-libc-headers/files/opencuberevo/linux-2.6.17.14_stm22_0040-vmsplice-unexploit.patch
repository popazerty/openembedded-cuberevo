Fix for vmsplice vulnerability.

Note that there have been vulnerabilities in vmsplice identified:

CVE-2008-0009
	was introduced in 2.6.22, and so 2.6.17 is not vulnerable.
	Upstream patch is the second hunk of:
	http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=8811930dc74a503415b35c4a79d14fb0b408a361

CVE-2008-0010
	 was introduced in 2.6.22, and so 2.6.17 is not vulnerable.
	 Has a public exploit: http://www.milw0rm.com/exploits/5093
	 Upstream patch is the first hunk of:
	 http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=8811930dc74a503415b35c4a79d14fb0b408a361

CVE-2008-0600
	was introduced in 2.6.17
	Has a public exploit: http://www.milw0rm.com/exploits/5092
	Upstream fix:
	http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=712a30e63c8066ed84385b12edbfb804f49cbc44

This patch is a backport of the final commit to 2.6.17.

Signed-off-by: Stuart Menefy <stuart.menefy@st.com>
Index: linux/fs/splice.c
===================================================================
--- linux.orig/fs/splice.c
+++ linux/fs/splice.c
@@ -1126,7 +1126,7 @@ static int get_iovec_page_array(const st
 		if (unlikely(!len))
 			break;
 		error = -EFAULT;
-		if (unlikely(!base))
+		if (!access_ok(VERIFY_READ, base, len))
 			break;
 
 		/*
